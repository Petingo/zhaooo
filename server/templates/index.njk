{% extends "base.njk" %}

{% block left_nav %}
    <div style="height:100%;">
        <div class="card text-center" style="width: 100%;">
            <ul class="list-group list-group-flush">
                <li class="pt-2">
                    <img src="/static/media/img/avatar.svg" alt="Avatar" style="width: 60%">
                    <p>
                        {{user_name}}
                    </p>
                </li>
                <a id="wall-link" class="list-group-item" href="#">
                    å‹•æ…‹ç‰†
                </a>
                <a id="class-link" class="list-group-item" href="#">
                    ç­ç´šçœ‹æ¿
                </a>
            </ul>
        </div>
        <form action="select_board" method="post">
            <div class="card text-center mt-3" style="width: 100%;">
                <div class="card-header">
                    ç†±é–€çœ‹ç‰ˆ
                </div>
                <ul class="list-group list-group-flush">
                    {# <a id="gossiping-link" class="list-group-item" href="#">
                        å…«å¦
                    </a>
                    <a id="gossiping-link" class="list-group-item" href="#">
                        è¥¿æ–¯
                    </a>
                    <a id="gossiping-link" class="list-group-item" href="#">
                        è¡¨ç‰¹
                    </a>
                    <a id="gossiping-link" class="list-group-item" href="#">
                        å¸Œæ´½
                    </a>
                    <a id="gossiping-link" class="list-group-item" href="#">
                        é›»è¦
                    </a> #}
                    <button id="gossiping-link" class="list-group-item" name="select_board" value="å…«å¦">å…«å¦</button>
                    <button id="gossiping-link" class="list-group-item" name="select_board" value="è¥¿æ–¯">è¥¿æ–¯</button>
                    <button id="gossiping-link" class="list-group-item" name="select_board" value="è¡¨ç‰¹">è¡¨ç‰¹</button>
                    <button id="gossiping-link" class="list-group-item" name="select_board" value="å¸Œæ´½">å¸Œæ´½</button>
                    <button id="gossiping-link" class="list-group-item" name="select_board" value="é›»è¦">é›»è¦</button>
                </ul>
            </div>
        </form>
    </div>

    {# <a id="wall-link" class="nav-link" href="#">å‹•æ…‹ç‰†</a>
        <a id="class-board-link" class="nav-link" href="#">ç­ç´šçœ‹æ¿</a>
        <p>
            <a id="board-link" class="btn btn-primary" data-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                æœ€æ„›çœ‹ç‰ˆ
            </a>
        </p>
        <div class="collapse" id="collapseExample"></div> #}

{% endblock %}

{% block content %}
    {# <script>
        function PostArticleData(){
            var formArticle = document.forms['article']
            var timestamp = Date.now()
            formArticle.timestamp.value = timestamp
            console.log("fuck")
        }
    </script> #}

    <!-- Button trigger modal -->
    <button type="button" id="post-article" class="btn btn-warning" data-toggle="modal" data-target="#exampleModal">
        ç™¼å»¢æ–‡
    </button>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">ç™¼å»¢æ–‡</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <form id="article" action="post_article" method="post">

                    <div class="modal-body">
                        <div class="form-group">
                            <textarea class="form-control" name="content" rows="3"></textarea>
                        </div>
                        <div class="form-group form-check" style="margin-bottom: 0px">
                            <input type="checkbox" class="form-check-input" name="anonymous">
                            <label class="form-check-label" for="exampleCheck1">åŒ¿åç™¼è¡¨</label>
                        </div>
                    </div>
                    
                    {# é¸çœ‹æ¿ç”¨çš„ #}
                    <input id="select-board" type="hidden" name="input_board">

                    <div class="modal-footer">
                        <button id="select-post-board" class="btn btn-info dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">å…«å¦</button>
                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                            <a class="dropdown-item select-post-board-item" href="#">å…«å¦</a>
                            <a class="dropdown-item select-post-board-item" href="#">è¥¿æ–¯</a>
                            <a class="dropdown-item select-post-board-item" href="#">å‘Šç™½</a>
                            <a class="dropdown-item select-post-board-item" href="#">å¸Œæ´½</a>
                            <a class="dropdown-item select-post-board-item" href="#">é›»è¦</a>
                        </div>
                        <script>
                            $(function () {
                                $(".select-post-board-item").click(function () {
                                    $("#select-post-board").text($(this).text());
                                    $("#select-post-board").val($(this).text());
                                    $("#select-board").val($(this).text());
                                });
                            });
                        </script>
                        {# <button type="button" class="btn btn-secondary" data-dismiss="modal">å–æ¶ˆ</button> #}
                        <button id="submit-article" class="btn btn-primary" type="submit">ç™¼å°„</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div style="height:100%;">
        {% for item in articles %}
            <div class="card mt-3" style="width: 100%;">
                <div class="card-body">
                    <span><img src="/static/media/img/avatar.svg" alt="Avatar" style="height: 2.5rem; margin-left: -5px; margin-bottom: 0.5rem" class="mr-2">
                        <span class="name" style="font-size: 1.5rem; padding-top:0.5rem">{{ item.name }}</span></span>
                    <h6 class="time mb-2 text-muted">{{ item.time }}</h6>
                    <p class="content">{{ item.content }}</p>

                    <form id="article" action="article_motion" method="post" target="hiddenFrame">
                        <input type="hidden" name="post-id" value="{{item.id}}">

                        <input type="submit" value="ğŸ˜" id="{{item.id}}" class="btn btn-mood btn-mood-love" name="action"/>
                        <span id="love-amount-{{item.id}}" class="span-mood-love">{{ item.love }}</span>

                        <span style="margin: 0px 1rem;"></span>

                        <input type="submit" value="ğŸ˜¡" id="{{item.id}}" class="btn btn-mood btn-mood-angry" name="action"/>
                        <span id="angry-amount-{{item.id}}" class="span-mood-angry">{{ item.angry }}</span>

                    </form>
                    {# <a href="#" class="like"></a> #}
                </div>
            </div>
        {% endfor %}
        <script>
            $(function () {
                $(".btn-mood").click(function () {
                    console.log(this)
                    let id = $(this).attr('id')
                    let classes = $(this).attr('class')
                    if (classes.indexOf('angry') > -1) {
                        let showText = $("#angry-amount-" + id)
                        showText.text(parseInt(showText.text()) + 1)
                    } else if (classes.indexOf('love') > -1) {
                        let showText = $("#love-amount-" + id)
                        showText.text(parseInt(showText.text()) + 1)
                    }
                });
            });
        </script>
    </div>
{% endblock %}